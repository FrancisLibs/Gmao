{% extends 'base.html.twig' %}

{% block title %}Machines{% endblock %}

{% block body %}
    <div class="row mt-4 mb-3 mr-5 justify-content-between">
        <div class="col-3 offset-2">
            {% if mode == "selectPreventive" %}
                <h3>Machines -> BT préventif</h3>
            {% elseif mode == "newWorkorder" %}
                <h3>Machine -> BT</h3>
            {% else %}
                <h3>Machines</h3>
            {% endif %}
        </div>
        {% if machinesWithData is defined and machinesWithData is not empty %}
            <div class="col-5">
                <div class="border border-primary rounded p-1">
                    <h5 class="text-primary mb-2">Machines du BT préventif : 
                        {{ machinesWithData|length }}
                        {% if mode == 'editPreventive' %}
                            <a href="{{ path('template_edit', {'id': documentId, 'mode': mode}) }}" class="btn btn-sm btn-primary ml-4" role="button">Valider</a>
                        {% else %}
                            <a href="{{ path('template_new') }}" class="btn btn-sm btn-primary ml-4" role="button">Valider</a>
                        {% endif %}
                    </h5>
                    <div class="mr-2 p-2 mb-2 ">
                        <div class="row mb-1">
                            <div class="col-2 text-uppercase font-weight-bold text-primary">Code</div>
                            <div class="col-5 text-uppercase font-weight-bold text-primary">Désignation</div>
                            <div class="col-2"></div>
                        </div>
                        {% for machine in machinesWithData %}
                            <div class="row mb-1">
                                <div class="col-2">{{ machine.internalCode }}</div>
                                <div class="col-8">{{ machine.designation}}</div>
                                <div class="col-2">
                                    {% if( mode == 'editPreventive') %}
                                        <a href="{{ path('remove_machine_from_cart', {'id': machine.id, 'mode': mode, 'documentId': documentId}) }}" style="margin-top: -3px;" class="btn btn-warning btn-sm" role="button">Supp</a>
                                    {% else %}
                                        <a href="{{ path('remove_machine_from_cart', {'id': machine.id, 'mode': mode} ) }}" style="margin-top: -3px;" class="btn btn-warning btn-sm" role="button">Supp</a>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endif %}
        
    </div>
    <section class="row deliveryNote-js-filter">
        <aside class="col-2">
            <section>
                {% if mode != 'selectPreventive' and mode != 'workorderSelect' %}
                    <a class="btn btn-primary btn-sm mt-2 mb-3" href="{{ path('machine_new') }}" role="button">Nouvelle machine</a>
                {% endif %}
                {% include 'machine/_filter.html.twig' %}
            </section>
            {% include 'user/_photo.html.twig' %}
        </aside>
        <article class="col-10">
            {% include 'machine/_machineList.html.twig' with {machines: machines, mode: mode, documentId: documentId} only %}
        </article>
            {# display navigation #}
            <div class="col-5 offset-2 navigation js-filter-pagination">
                {% include 'machine/_pagination.html.twig' %}
            </div>
        </article>
    </section>
{% endblock %}