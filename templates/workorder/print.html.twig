<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bon de Travail</title>
    <style> 
        .tabulation { 
        display: inline-block; 
        margin-left: 40px; 
        } 
    </style> 
</head>
<body>
    <div>
        {% if workorder.preventive %}
            <h1 style="color: red; font-family: serif;">Bon de Travail préventif {{ workorder.id }}</h1>
            <span>Date prévue : {{ workorder.preventiveDate|date('d/m/Y') }}</span>
            <span class="tabulation"></span>
            <span>Numéro de préventif : {{ workorder.templateNumber }}</span>
        {% else %}
            <h1>Bon de Travail {{ workorder.id }}</h1>
        {% endif %}
    </div>
    <div class="row mt-4">
        <span>Créé le : {{ workorder.createdAt ? workorder.createdAt|date('d/m/Y', timezone="Europe/Paris") : '' }}</span>
        <br>
        <span>Par : {{ workorder.user.firstName }}</span>
        <br>
        <span>Statut : {{ workorder.workorderStatus.name }}</span>
    </div>

    <div class="row mt-4">
        <p style="font-size: 1.2em; font-weight: bold; text-align: left;">Machine(s) :</p>
        <table>
            <thead>
                <tr>
                    <th style="text-align: left;"scope="col">Numéro</th>
                    <th style="text-align: center;" scope="col">Machines</th>
                    <th style="text-align: center;" scope="col">Num. série</th>
                    <th style="text-align: center;" scope="col">Constructeur</th>
                </tr>
            </thead>
            <tbody>
                {% for machine in workorder.machines %}
                    <tr>
                        <td>{{ machine.internalCode }}</td>
                        <td style="text-align: center;">{{ machine.designation }}</td>
                        <td style="text-align: center;">{{ machine.serialNumber }}</td>
                        <td style="text-align: center;">{{ machine.constructor }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div>
        <h5>Demande : </h5>
        {{ workorder.request|nl2br }}
    </div>

    <div>
        <h5>Réalisation : </h5>
        {{ workorder.implementation|nl2br }}
    </div>  

    <div>
        <h5>Remarque : </h5>
        {{ workorder.remark|nl2br }}
    </div>

    {% if workorder.workorderParts is not empty %}
        <div>
            <h5>Pièces détachées</h5>
            <div>
                <table>
                    <tr>
                        <th style="text-align: left;" scope="col">Code</th>
                        <th style="text-align: center;">Qte</th>
                        <th style="text-align: center;" scope="col">Désignation</th>
                        <th style="text-align: center;" scope="col">Qte stock</th>
                        <th style="text-align: center;" scope="col">Prix</th>
                    </tr>
                    <tbody>
                        {% for part in workorder.workorderParts %}
                            <tr>
                                <td style="text-align: left;">{{ part.part.code }}</td>
                                <td style="text-align: center;">{{ part.quantity }}</td>
                                <td style="text-align: center;">{{ part.part.designation }}</td>
                                <td style="text-align: center;">{{ part.part.stock.qteStock }}</td>
                                {% if part.part.steadyPrice > 0 %}
                                    <td style="text-align: center;">{{ part.part.steadyPrice }}</td>
                                {% else %}
                                    <td style="text-align: center;">-</td>
                                {% endif %}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    {% endif %}
</body>
</html>

